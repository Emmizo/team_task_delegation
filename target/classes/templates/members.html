<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Team Members</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2rem; background-color: #f7f8fa; }
        h1 { color: #111827; }
        .card { background: #fff; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,.08); margin-bottom: 1.5rem; }
        label { font-weight: bold; display: block; margin-top: 1rem; }
        input[type=text], input[type=number], textarea { width: 100%; padding: 0.6rem; border-radius: 6px; border: 1px solid #cdd5df; margin-top: 0.3rem; }
        textarea { min-height: 100px; }
        button { margin-top: 1.2rem; padding: 0.75rem 1.5rem; border: none; border-radius: 6px; background-color: #2563eb; color: #fff; font-size: 1rem; cursor: pointer; }
        table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        th, td { padding: 0.5rem; border-bottom: 1px solid #e5e7eb; text-align: left; }
        .message { color: #047857; font-weight: bold; }
        .error { color: #b91c1c; margin-top: 0.5rem; }
        nav a { margin-right: 1rem; color: #2563eb; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>
<nav>
    <a href="/assignment">Assignment</a>
    <a href="/members">Team Members</a>
</nav>

<div class="card">
    <h1>Add a team member</h1>
    <p>Capture skills and workload. Use one entry per line for skills/projects (e.g., <code>frontend:0.8</code>).</p>

    <div class="message" th:if="${message}" th:text="${message}"></div>

    <form th:action="@{/members}" th:object="${memberForm}" method="post">
        <label>Name
            <input type="text" th:field="*{name}" placeholder="Nia Productor"/>
        </label>
        <div class="error" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></div>

        <label>Recent performance (0-1)
            <input type="number" step="0.05" min="0" max="1" th:field="*{performance}"/>
        </label>

        <label>Growth desire (0-1)
            <input type="number" step="0.05" min="0" max="1" th:field="*{growth}"/>
        </label>

        <label>Skills
            <textarea th:field="*{skillsRaw}"></textarea>
        </label>

        <label>Active projects (format <code>project:weeks</code>)
            <textarea th:field="*{projectsRaw}" placeholder="Platform upgrade:6"></textarea>
        </label>

        <button type="submit">Save member</button>
    </form>
</div>

<div class="card">
    <h2>Roster overview</h2>
    <table>
        <thead>
        <tr>
            <th>Name</th>
            <th>Performance</th>
            <th>Growth</th>
            <th>Skills</th>
            <th>Active projects</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="member : ${members}">
            <td th:text="${member.name}"></td>
            <td th:text="${#numbers.formatDecimal(member.recentPerformance, 1, 2)}"></td>
            <td th:text="${#numbers.formatDecimal(member.growthDesire, 1, 2)}"></td>
            <td>
                <span th:each="skill : ${member.expertise.skillNames}"
                      th:text="${skill}"
                      style="display:inline-block; background:#e0e7ff; padding:0.1rem 0.4rem; border-radius:4px; margin:0.1rem;"></span>
            </td>
            <td>
                <div th:each="load : ${member.currentProjects}"
                     th:text="${load.projectName + ' (' + load.remainingWeeks + 'w)'}"></div>
                <div th:if="${member.currentProjects.isEmpty()}">-</div>
            </td>
        </tr>
        <tr th:if="${#lists.isEmpty(members)}">
            <td colspan="5">No members yet.</td>
        </tr>
        </tbody>
    </table>
</div>
</body>
</html>

